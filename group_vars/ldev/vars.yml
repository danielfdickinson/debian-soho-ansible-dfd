---
admin_base_homedir: "{{ vault_admin_base_homedir }}"
admin_gecos: "{{ vault_admin_gecos }}"
admin_password: "{{ vault_admin_password }}"
admin_ssh_key: "{{ vault_admin_ssh_key }}"
admin_user: "{{ vault_admin_user }}"
ansible_become_password: "{{ vault_ansible_become_password }}"
ansible_ssh_common_args: "{% if 'external_ssh' not in group_names %}-o ProxyCommand=\"ssh -o StrictHostKeyChecking=no -p {{ bastion_port }} -W %h:%p -q {{ bastion_user }}@{{ bastion_host }}\"{% endif %}"
ansible_ssh_host_key_checking: false # Note: this should be true in production
ansible_ssh_port: "{{ vault_ansible_ssh_port }}"
ansible_ssh_user: "{{ vault_ansible_ssh_user }}"
bastion_host: "{{ vault_bastion_host }}"
bastion_port: "{{ vault_bastion_port }}"
bastion_ssh_key: "{{ vault_bastion_ssh_key }}"
bastion_user: "{{ vault_bastion_user }}"
central_external_domain: "{{ vault_central_external_domain }}"
central_external_email: "{{ vault_central_external_email }}"
central_internal_domain: "{{ vault_central_internal_domain }}"
central_internal_email: "{{ vault_central_internal_email }}"
remote_admin_ip: "{{ vault_remote_admin_ip }}"
remote_ignore_ips: "{{ remote_admin_ip }}{% if remote_monitoring_ips is defined %} {{ remote_monitoring_ips }}{% endif %}"
remote_monitoring_ips: "{{ vault_remote_monitoring_ips }}"
submission_relay_host: "{{ hostvars['imapldev.ldev']['ansible_facts']['fqdn'] }}"
v4nat_net: "{{ ansible_facts['default_ipv4']['network'] }}"
v4nat_prefix: "{{ ansible_facts['default_ipv4']['prefix'] }}"
v6nat_net: "{{ ansible_facts['default_ipv6']['address'] }}"
v6nat_prefix: "{{ ansible_facts['default_ipv6']['prefix'] }}"
fallback_dns: "{{ vault_env_conn_admin[envname]['fallback_dns'] }}"
internal_relay_port: "{{ vault_env_conn_admin[envname]['internal_relay_port'] }}"
libvirt_client_ssh_key: "{{ vault_env_conn_admin[envname]['libvirt_client_ssh_key'] }}"
libvirt_client_user: "{{ vault_env_conn_admin[envname]['libvirt_client_user'] }}"
local_freshclam_mirror: "{{ vault_env_conn_admin[envname]['local_freshclam_mirror'] }}"
mail_local_destinations: "{{ default_mail_local_destinations }}"
mailbox_server_address: "{{ ipaddrs['v4addr']['imapldev'] }}"
mailbox_server_fqdn: "{{ hostvars['imapldev.ldev']['ansible_facts']['fqdn'] }}"
opendkim_private_key: "{{ vault_env_conn_admin[envname]['opendkim_private_key'] | default(None) }}"
postfix_mua_authorized_xclient_hosts: "{{ ipaddrs['v4addr']['imapldev'] }} [{{ ipaddrs['v6addr']['imapldev'] }}]"
submission_port: 587
v6natnet_ula: "{{ vault_env_conn_admin[envname]['v6natnet_ula'] }}"
ipaddrs:
  v4addr:
    gateldev: "{{ hostvars['gateldev.ldev']['ansible_facts']['default_ipv4']['address'] }}"
    gdavldev: "{{ hostvars['gdavldev.ldev']['ansible_facts']['default_ipv4']['address'] }}"
    imapldev: "{{ hostvars['imapldev.ldev']['ansible_facts']['default_ipv4']['address'] }}"
    smtp01ldev: "{{ hostvars['smtp01ldev.ldev']['ansible_facts']['default_ipv4']['address'] }}"
  v6addr:
    gateldev: "{{ hostvars['gateldev.ldev']['ansible_facts']['default_ipv6']['address'] }}"
    gdavldev: "{{ hostvars['gdavldev.ldev']['ansible_facts']['default_ipv6']['address'] }}"
    imapldev: "{{ hostvars['imapldev.ldev']['ansible_facts']['default_ipv6']['address'] }}"
    smtp01ldev: "{{ hostvars['smtp01ldev.ldev']['ansible_facts']['default_ipv6']['address'] }}"
...
